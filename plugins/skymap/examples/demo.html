<!doctype html><title>Minimal tQuery Page</title>
<script src="../../../build/tquery-bundle-require.js"></script>
<script src="../../linkify/tquery.mesh.linkify.js"></script>
<body><script>
require(['tquery.skymap', 'tquery.text', 'tquery.planets', 'tquery.domevent',
	'tquery.pproc'
	], function(){
		

	var world	= tQuery.createWorld().boilerplate().start();

	world.addEffectComposer()
		//.sepia()
		.film(0.25, 0.25, 648, false)
		.vignette()
		.finish();

	// setup light
	tQuery.createDirectionalLight().addTo(world).position(1,1,1);
	tQuery.createDirectionalLight().addTo(world).position(-1,0,1);
	tQuery.createAmbientLight().addTo(world).color(0xFFFFFF);

	//////////////////////////////////////////////////////////////////////////
	//		Handle planet						//
	//////////////////////////////////////////////////////////////////////////	
	
	// add planets
	var planet	= tQuery.createPlanet('earthNormal').id('planet').addTo(world);
	//var planet	= tQuery.createPlanet('earth').addTo(world);
	planet.get(0).eulerOrder = 'XZY';

	// make the object rotate
	world.loop().hook(function(delta, now){
		// handle planet rotation
		var angle	= 0.1 * now * Math.PI * 2;
		planet.get(0).rotation.y	= -angle;
		planet.get(0).rotation.z	= 23.1 * Math.PI/180;

		// handle planet revolution
		var angle	= 0.05 * now * Math.PI * 2;
		planet.get(0).position.x = 2.0 * Math.cos(angle);
		planet.get(0).position.y = 0.5 * Math.cos(angle+Math.PI/2);
		planet.get(0).position.z = 1.0 * Math.sin(angle);
	});

	//////////////////////////////////////////////////////////////////////////
	//		Handle camera control					//
	//////////////////////////////////////////////////////////////////////////

	// make camera controls go smoother
	var controls	= tQuery.world.getCameraControls();
	controls.rangeX	*= 0.03;
	controls.rangeY	*= 0.03;
	
	//////////////////////////////////////////////////////////////////////////
	//		Handle skymap						//
	//////////////////////////////////////////////////////////////////////////	
	
	// add a skymap
	var skymap	= tQuery.createSkymap('swedishRoyalCastle').addTo(world);

	//////////////////////////////////////////////////////////////////////////
	//		Handle 'preregister' button				//
	//////////////////////////////////////////////////////////////////////////
	
	// enable domEvent on this world
	world.enableDomEvent();
	var textEnvMap	= tQuery.createCubeTexture('skybox');
	var button	= tQuery.createText("Github").addTo(world)
		.scaleBy(1/8)
		.translateY(-0.3)
		.setBasicMaterial({
			envMap	: textEnvMap,
			color	: 0x5577ff
		}).back()
		.linkify('https://github.com/jeromeetienne/tquery/');

// TODO make the bounding box part of the linkify. it is more natural ?
// maybe on options
if( false ){
	var size	= button.geometry().computeAll().size();
	tQuery.createCube(size.x, size.y, size.z)
		.scaleBy(1.2)
		.addTo(button)
		.setBasicMaterial({
			wireframe	: true
		}).back()
		.linkify('https://github.com/jeromeetienne/tquery/');	
}
	//////////////////////////////////////////////////////////////////////////
	//		Handle text						//
	//////////////////////////////////////////////////////////////////////////	

	// create the text
	var text	= tQuery.createObject3D().addTo(world)
				.translateY(0.3)
	var textEnvMap	= tQuery.createCubeTexture('skybox');
	tQuery.createText("tQuery is Fun!", {
		// font	: "gentilis",
		// weight	: "regular",
	}).addTo(text)
		.scaleBy(1/4)
		.setBasicMaterial({
			color	: 0xffffff,
			envMap	: textEnvMap
		}).back()
	tQuery.createText("Super Fun", {
		// font	: "gentilis",
		// weight	: "regular",
	}).addTo(text)
		.scaleBy(1/8)
		.translateY(-0.25)
		.translateX(0.8)
		.setBasicMaterial({
			envMap	: textEnvMap
		}).back()


});
</script></body>