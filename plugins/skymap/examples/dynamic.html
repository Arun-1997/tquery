<!doctype html><title>Minimal tQuery Page</title>
<script src="../../../build/tquery-bundle-require.js"></script>
<body><script>
require([ 'tquery.skymap'
	, 'tquery.grassground'
	, 'tquery.minecraft'
], function(){
	var world	= tQuery.createWorld().boilerplate().start();

	world.camera().positionZ(2)

	var cubeTexture	= tQuery.createCubeTexture('mars');
	tQuery.createSkymap(cubeTexture).addTo(world);


	var cubeCamera	= new THREE.CubeCamera( 0.001, 1000, 1024 );
	// to avoid flickering on the border of the sphere
	cubeCamera.renderTarget.minFilter = THREE.LinearMipMapLinearFilter;

	var sphere	= tQuery.createSphere().addTo(world)
		.setBasicMaterial()
			.envMap(cubeCamera.renderTarget)
			.color('yellow')
			.back()
			
	world.hook(function(delta, now){
		sphere.rotateY( 0.1 * delta * Math.PI*2)
	})




	tQuery(cubeCamera).addTo(sphere)

	world.hook(function(){
		sphere.visible(false)	// *cough*

		cubeCamera.updateCubeMap( world.tRenderer(), world.tScene() );

		sphere.visible(true)	// *cough*
	})
	
	
	var container	= tQuery.createObject3D().addTo(world).positionY(-0.5)
	tQuery.createTorusKnot().addTo(container).position( 0, 0, 1)
	tQuery.createTorusKnot().addTo(container).position( 0, 0,-1)
	tQuery.createTorusKnot().addTo(container).position( 1, 0, 0).rotateY( Math.PI/2)
	tQuery.createTorusKnot().addTo(container).position(-1, 0, 0).rotateY(-Math.PI/2)
	
	world.hook(function(delta, now){
		container.rotateY( 0.3 * delta * Math.PI*2)
	})
})
</script></body>